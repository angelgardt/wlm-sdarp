# Введение в статистику {#desc-statintro}

{{< include other/_symbols.qmd >}}

```{r opts, echo=FALSE, eval=TRUE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, warning = FALSE, message = FALSE, error = FALSE)
```

```{r pkgs}
library(tidyverse)
theme_set(theme_bw())
# library(plotly)
```

:::{.intro}
Итак, мы вплотную подошли к изучению статистики, однако прежде чем мы начнем разговор собственно о статистике, нам необходимо разобраться, что вообще это такое, когда́ оно нам жизненно необходимо и заче́м оно нам жизненно необходимо, чтобы первично сориентироваться в том, о чем мы будем говорить на протяжении всех последующих глав.

Так и поступим.
:::



## Исследовательский процесс {#desc-statintro-research-process}

:::{.lab-junior}
:::

Прежде всего, давайте сориентируемся в том, как устроен исследовательский процесс. В самом общем виде его можно разбить на различные этапы --- я предлагаю рассмотреть следующую схему (@fig-research-process-qq):

```{mermaid}
%%| label: fig-research-process-qq
%%| fig-cap: Соотношение качественных и количественных исследований в исследовательском процессе
%%| fig-align: center

flowchart TD
  idea("Идея исследования")
  literature("Изучение литературы")
  resques("Исследовательский_е вопрос_ы")
  qualres("Качественное исследование")
  hyps("Гипотеза_ы")
  quanres("Количественное исследование")
  results1("Осмысление результатов")
  results2("Осмысление результатов")
  newresq("Новый_е
          исследовательский_е вопрос_ы")
  newhyp("Новая_ые гипотеза_ы")
  
  idea --> literature
  literature --> resques
  resques --> qualres
  qualres --> results1
  results1 --> hyps
  hyps --> quanres
  quanres --> results2
  results2 --> newresq
  results2 --> newhyp
  newresq --> qualres
  newresq --> quanres
  newhyp --> quanres
```

Безусловно, любое исследование начинается с некоторой **идеи** --- что мы вообще собираемся изучать? Идею исследования можно взять практически откуда угодно: из жизненного опыта, повседневных наблюдений, видео на YouTube, поста в блоге или практического опыта, наконец, учебных материалов и научных статей. Однако идеи, как правило, недостаточно для того, чтобы спланировать исследование, поэтому далее мы идём в базы **научной литературы**, чтобы изучить интересующую нас область пока что теоретически --- что вообще по этому поводу уже наисследовано и написано, какие известны закономерности, может быть, уже разработаны даже какие-либо модели интересующих нас феноменов. Обычно изучение литературы заканчивается **теоретическим обзором**, который приводит нас к формулированию **исследовательского вопроса** --- одного или нескольких в зависимости от того, насколько широка была наша идея.

Имея результаты теоретического обзора и исследовательский вопрос мы можем пойти двумя путями: 

* если интересующая нас область достаточно хорошо исследована, наш исследовательский вопрос достаточно конкретный и обзор литературы позволяет нам сразу сформулировать к нему **гипотезы**, то мы можем перейти к планированию **количественного исследования**;
* если же интересующий нас феномен изучен недостаточно, мы не вполне пониманием, что мы собираемся исследовать и как сие организовано «в сознании людей», нам стоит сначала провести **качественное исследование**, чтобы получить больше информации для формулирования гипотез --- именно этот путь представлен на [иллюстрации @fig-research-process-qq].

Безусловно, качественные и количественные исследования существенно различаются собственной методологией, о чем подробнее можно прочитать в [приложении](appendix-research-design.qmd). Однако как качественное, так и количественное исследование заканчивается написанием отчёта какого-либо формата --- статьи, курсовой, дипломной работы или внутреннего отчета организации --- и приводит нас к **новым идеям, гипотезам и исследованиям**. Так, цикл исследовательского процесса замыкается и может повторяться бесконечно, ибо научное познание не имеет пределов.

Часто качественные и количественные исследования рассматривают изолированно друг от друга, что, на мой взгляд, не вполне соответствует исследовательской реальности. Конечно, исследования обоих типов могут проводится независимо друг от друга, если того требуют исследуемые феномены. Тем не менее, это вовсе не значит, что они никогда не встречаются друг с другом. Напротив, совмещение качественной и количественной методологии часто встречается в индустрии примерно в той логике, которая представлена на [иллюстрации @fig-research-process-qq], и именно поэтому мы уделили несколько абзацев её рассмотрению.

И всё же в силу того, что мы сосредоточены в этой книжке на изучении статистики и анализа количественных данных, далее мы будем рассматривать именно количественные исследования и начнем с того, что разберемся как в них устроен исследовательский процесс.



### Исследовательский процесс в количественных исследованиях {#desc-statintro-research-process-quan}

:::{.lab-junior}
:::

Итак, пусть мы решили, что проводим количественное исследование. Какие этапы нам предстоит пройти, прежде чем мы получим ответ на наш исследовательский вопрос? Снова представим процес в виде схемы (@fig-research-process-quan):

```{mermaid}
%%| label: fig-research-process-quan
%%| fig-cap: Исследовательский процесс в количественных исследованиях
%%| fig-align: center

flowchart TD
  idea("Идея исследования / Исследовательский вопрос")
  literature("Теоретический обзор")
  constructs("Конструкты")
  theorhyp("Теоретические гипотезы")
  design("Дизайн исследования")
  sample(["Выборка"])
  vars(["Переменные
        Процедура"])
  empirhyp(["Эмпирические гипотезы"])
  plananalysis(["План анализа"])
  prog("Программирование эксперимента / Составление опроса")
  datacollection("Сбор данных")
  dataanalysis("Анализ данных")
  preproc(["Предобработка данных"])
  desc(["Описательные статистики"])
  statmethods(["Статистические методы"])
  stathyp(["Статистические гипотезы"])
  statres(["Статистические результаты"])
  statinterp(["Статистическая интерпретация"])
  interpretation("Интерпретация результатов")
  discussion("Обсуждение результатов")
  report("Написание отчета")
  
  idea ==> literature
  literature -.-> constructs
  constructs -.-> theorhyp
  literature ==> theorhyp
  theorhyp ==> design
  design --> sample
  design --> vars
  vars --> empirhyp
  empirhyp --> plananalysis
  design ==> prog
  prog ==> datacollection
  datacollection ==> dataanalysis
  dataanalysis --> preproc
  preproc --> desc
  desc --> statmethods
  statmethods --> stathyp
  stathyp --> statres
  statres --> statinterp
  statinterp --> interpretation
  dataanalysis ==> interpretation
  interpretation ==> discussion
  discussion ==> report
  %% report -.-> idea
  
  %% style sample color:#A3F09C
```

Мы вновь начинаем с **идеи** исследования или **исследовательского вопроса**, прочитываем необходимую **литературу**, при необходимости определяем исследуемые **конструкты** и приходим к **теоретическим гипотезам** нашего исследования.



## Что такое статистика? {#desc-statintro-what-is-stat}

:::{.lab-junior}
:::

Чем же в итоге занимается статистика? Что она изучает?

:::{#def-statistics}
**Статистика** --- это междисциплинарная область знаний, а также практической деятельности, изучающая массовые явления, а также принципы и методы работы с данными, характеризующими эти явления [@sirotin2018].
:::

Это, пожалуй, наиболее общее определение, которое весьма красиво звучит, но явно требует пояснений.

Массовые явления затрагивают огромные количества людей. Огромность этих масс, конечно, различна. Скажем, базовые перцептивные закономерности, связанные с тем, как устроена зрительная система, охватывают *всех людей*. Уровень удовлетворенности жизнью россиян охватывает только *население России*. Городские блага петербуржцев --- только для *жителей Санкт-Петербурга*. Учебная мотивация студентов психологического факультета некоторого вуза --- это только про *студентов-психологов этого вуза*. Однако так или иначе эти группы составляет не 5--10 человек, а десятки, сотни, тысячи или миллионы.

Собственно, статистика и возникает именно тогда, когда нам нужно изучать большие --- очень большие --- группы людей. Можно было бы, наверно, озадачится изучением всех представителей интересующей нас группы, однако это требует много времени и денег --- ни того, ни другого, как правило, в наличии не присутствует. Приходится ограничиваться рассмотрением *части интересующей нас группы людей*.



## Выборка и генеральная совокупность {#desc-statintro-population-sample}

:::{.lab-junior}
:::

Одним из ключевых понятий статистики является **генеральная совокупность (population)** --- множество всех [существующих] исследуемых объектов, а также сведения о них. **Объемом генеральной совокупности** ($N$) называют число объектов, составляющих генеральную совокупность. Как мы отметили выше, $N$ в подавляющем большинстве случаев крайне велико, поэтому мы не можем работать с генеральной совокупностью целиком --- в ходе исследования мы работаем с *выборкой*.

**Выборка, или выборочная совокупность (sample)** --- это некоторая часть генеральной совокупности, формируемая в ходе проведения исследований. Выборка характеризуется **объёмом** ($n$), при этом объем выборки всегда существенно меньше объёма генеральной совокупности ($n \ll N$[^ll_symbol]).

[^ll_symbol]: Символ $\ll$ читается как «много меньше».

Получается следующая логика (@fig-sampling-inference):

1. мы **формируем выборку (sampling)** из генеральной совокупности
2. изучаем получившуюся выборку в исследовании
3. по полученным результатам **делаем выводы (inference)** о генеральной совокупности

![Выборка и генеральная совокупность](img/desc-statintro/sampling-inference.png){#fig-sampling-inference}



## Признаки, параметры, оценки {#desc-statintro-param-estim}

:::{.lab-junior}
:::

В ходе исследования мы изучаем **признаки**, которыми обладают интересующие нас объекты рассматриваемой генеральной совокупности. Эти признаки выражаются *количественно* в определённых **показателях**. В качестве примеров признаков показателей, рассматриваемых в психологически исследованиях, можно привести следующие (@tbl-features):

::: {#tbl-features}

| Признаки                   	| Показатели                                             	|
|----------------------------	|--------------------------------------------------------	|
| Рабочая память             	| Объем рабочей памяти                                   	|
| Нейротизм                  	| Уровень нейротизма по BFI                              	|
| Заработная плата           	| Средняя заработная плата                               	|
| Когнитивная нагрузка       	| Уровень когнитивной нагрузки по ЭЭГ-коррелятам         	|
| Доверие к ИИ               	| Уровень доверия к ИИ по опроснику TAIA                 	|
| Индивидуализм/коллективизм 	| Индекс индивидуализма/коллективизма по модели Хофстеде 	|

Примеры признаков и показателей в психологических исследованиях

:::

Признаки могут быть очень разными, как и показатели, которыми мы их пытаемся измерить, однако независимо от того, какой признак и с помощью какого показателя мы пытаемся изучать, *генеральная совокупность характеризуется некоторым параметром*.

:::{#def-parameter}
**Параметр** --- относительно постоянная [от одной совокупности к другой] величина, характеризующая генеральную совокупность по некоторому показателю.
:::

Что это значит? Что по сути есть этот *параметр*? Это значит, что *в принципе* существуют

* средний уровень нейротизма по BFI студентов-психологов города Москвы
* средний уровень доверия к ИИ по опроснику TAIA россиян пенсионного возраста
* средний уровень когнитивной нагрузки по ЭЭГ-коррелятам ($\alpha$ band, $\beta$ band, $\theta$ band)

и так далее. Проблем заключается в том, что

> **величина параметра, который мы изучаем, неизвестна и никогда не будет известна.**

Стоп, что?

Хотя понятно, как вычислить *средний уровень нейротизма по BFI студентов-психологов города Москвы* --- взять всех студентов-психологов Москвы, дать им заполнить опросник BFI, посчитать балл по шкале «нейротизм», сложить результаты и разделить на количество студентов --- на деле *такое провернуть невозможно*. Но почему? Причины две:

* В Москве слишком много студентов-психологов --- мы не сможем собрать данные со всех-всех-всех
* Любое наше измерение всегда содержит ошибку --- независимо от того физическое оно или психологическое

Аналогично дело обстоит с любыми другими параметрами.

Что же делать? Собственно за этим мы и формируем выборку. Мы не можем измерить величину параметра точно, но можем *предсказать её с определённой статистической точностью*, измеряя показатели на выборке. Выборка имеет ограниченный объём, и, измерив величину показателя у каждого объекта выборки, мы получим **[выборочную] оценку параметра (estimation)** --- эмпирический (измеримый) аналог параметра. В частности, если у нас есть выборка из 100 студентов-психологов Москвы, вполне возможно за некоторое время собрать данных по уровню их нейротизма с помощью опросника BFI и вычислить среднее арифметическое по этим 100 наблюдениям.

Далее мы часто будем говорить о параметрах генеральной совокупности и выборочных оценках, сейчас же приведем несколько примеров и обозначений, чтобы придать теоретическим речам некоторое фактическое содержание (@tbl-param-estim).

:::{#tbl-param-estim}

| Параметр генеральной совокупности                              	| Выборочная оценка                                       	|
|----------------------------------------------------------------	|---------------------------------------------------------	|
| $\mu$ --- генеральное среднее                                  	| $\hat \mu$, $\bar x$ --- выборочное среднее              	|
| $\sigma^2$ --- стандартное отклонение генеральной совокупности 	| $\hat \sigma^2$, $s^2$ --- дисперсия выборки            	|
| $\rho$ --- коэффициент корреляции генеральной совокупности     	| $\hat \rho$, $r$ --- выборочный коээффициент корреляции 	|

Примеры параметров и выборочных оценок

:::



### Зачем нужна статистика? {#desc-statintro-why-do-we-need-stat}

:::{.lab-junior}
:::

Мы в какой-то малоприятной ситуации… Мы хотим измерить то, что в определенном смысле невозможно измерить --- параметры генеральной совокупности --- при этом достаточно точно, чтобы потом это можно было сравнивать или строить какие-то модели. Задача выглядит заведомо провальной…

Однако именно в этот момент на помощь нам приходит статистика. Не в гордом одиночестве, конечно. Она проводит с собой теорию измерений, психометрику, теорию обнаружения сигнала и др. Всё это работает в нашей психологической науке в комплексе. Мы же сейчас сосредотачиваемся на статистической части этого салата.

Статистика даёт нам теоретический и математический инструментарий, чтобы мы могли делать какие-либо выводы по нашим собранным данным. К сожалению, как бы нам ни хотелось, мы не можем делать выводы по сырым данным, потому что измерения по выборке не отражают вот прям ровно то, что есть в генеральной совокупности. Нам их надо определенным образом обсчитать, чтобы наши выводы были корректными. Этим и занимается статистика.

Возможно, сейчас это звучит достаточно абстрактно, но на данном этапе будет достаточно некоторого интуитивного понимание того, зачем нужна статистика. Далее это обрастёт содержанием и уложится, я надеюсь, в достаточно стройную систему.

Итого,

> статистика обеспечает возможность делать выводы о генеральной совокупности по выборке.


### Этапы статистического моделирования {#desc-statintro-stat-modelling}

:::{.lab-middle}
:::

Обобщение результатов исследования, проведенного на выборке, на всю генеральную совокупность происходит в ходе **статистического моделирования**. Хотя это словосочетание обычно пробуждает в сознании ассоциации, связанные с большими вычисления и чуть ли не искусственным интеллектом, на самом деле, любой статистический анализ --- даже самая обычная простая линейная регрессия --- это уже статистическое моделирование. Ведь мы берем некоторую математическую модель, примеряем её к данным и делаем выводы о том, насколько хорошо она работает.

В статистическом моделировании независимо от того, какую именно модель мы строим или какой анализ проводим, можно выделить несколько этапов:

* **Определение целей и задач моделирования**
    * Здесь нам необходимо ответить на вопрос: что мы вообще пытаемся смоделировать и для чего? Этот этап неразрывно связан с определением целей и задач исследования в целом.
    * Как отмечалось выше, анализ данных, который по сути и есть статистическое моделирование, должен быть согласован с гипотезами и исследовательским вопросом --- этот этам ровно при эту согласованность.
* **Формализация модели**
    * Здесь нам надо принципиально понять, каков тип статистических моделей нам подходит для моделирования изучаемой закономерности.
    * Изучаем ли мы линейные взаимосвязи или нам необходимо нелинейная модель? Есть ли у нас группировка в данных, которую необходимо учесть, или нет? И другие вопросы, которые нам необходимо задать уже на этапе *дизайна исследования*, а именно --- *планирования анализа данных*.
* **Спецификация модели**
    * На этом этапе мы уточняем модель до уровня переменных (и их взаимодействий), которые в неё будут входить.
    * Иногда этот этап переносят ниже --- после сбора и предобработки данных --- однако согласно современным взглядам, это не вполне корректно.
    * Спецификация модели, как и формализация, является частью *планирования анализа данных*, то есть подэтапом *дизайна исследования*. Продумывание спецификации модели позволит посмотреть на дизайн исследования «аналитическим» взглядом и обнаружить потенциальные проблемы (например, взаимодействия трех переменных, которые крайне сложны для интерпретации).
* **Сбор данных и их предобработка**
    * Собственно, стандартная часть исследовательского процесса в любых эмпирических исследованиях.
* **Идентификация модели**
    * Иначе говоря, подбор коэффициентов модели, или вычисление выборочных оценок параметров генеральной совокупности.
* **Анализ модели**
    * Этот этап включает в себя проверку статистической значимости модели в целом и отдельных её коэффициентов, исследование выполнения математических допущений, оценку модели по метрикам качества и др. --- всё, что позволит сказать, насколько хороша получившаяся модель с точки зрения описания изучаемых закономерностей.
* **Верификация модели**
    * На последнем этапе осуществляется тестирование модели на новом наборе данных, то есть на тех наблюдениях, с которыми модель ещё не знакома.
    * Этот этап, прежде всего, актуален для задач машинного обучения, в рамках которого является необходимым шагом, однако иногда встречается и некоторых ситуациях научной и практической аналитики.



### Характеристики статистических данных {#desc-statintro-statdata}

Конечно же, статистическое моделирование происходит на **статистических данных**, которые мы собираем в ходе исследования. Эти данные *собираются на выборке* с помощью *измерения* интересующих нас показателей. Такое положение дел приводит нас к следующему обстоятельству: статистические данные обладают двумя ключевыми характеристиками --- *неопределенностью* и *вариативностью*.

<!---
Мы уже говорили об этих характеристиках данных, когда изучали теорию измерений, однако не лишним будет повторить это еще раз, потому что именно эти две характеристики делают нам всё статистическое веселье с оценками параметров и тестированием гипотез.
--->

* **Неопределенность**
* **Вариативность**



### Способы формирования репрезентативной выборки {#desc-statintro-sample-types}

#### Простая случайная выборка {#desc-statintro-simple-random-sample}

Самый просто способ, которым можно набрать репрезентативную выборку --- это **простая случайная выборка (simple random sample)**.

```{r desc-statintro-simple-random-sample-data}
n_pop <- 600
set.seed(100)
tibble(x = sample(0:1000, n_pop),
  y = sample(0:1000, n_pop),
  little_sample = sample(c(TRUE, FALSE), n_pop, prob = c(1, 9), replace = TRUE),
  medium_sample = sample(c(TRUE, FALSE), n_pop, prob = c(2, 8), replace = TRUE),
  big_sample = sample(c(TRUE, FALSE), n_pop, prob = c(4, 6), replace = TRUE)) -> data_simple_random_sample

data_simple_random_sample %>% 
  ggplot(aes(x, y)) +
  geom_point() +
  guides(x = "none",
  y = "none") +
  labs(x = "", y = "") -> simple_random_sample_graph

data_simple_random_sample %>% 
  ggplot(aes(x, y, color = little_sample)) +
  geom_point() +
  scale_color_manual(values = c(`TRUE` = "#000000", `FALSE` = "#b4b4b4")) +
  guides(x = "none",
  y = "none",
  color = "none") +
  labs(x = "", y = "") -> simple_random_sample_little_sample_graph

data_simple_random_sample %>% 
  ggplot(aes(x, y, color = medium_sample)) +
  geom_point() +
  scale_color_manual(values = c(`TRUE` = "#000000", `FALSE` = "#b4b4b4")) +
  guides(x = "none",
  y = "none",
  color = "none") +
  labs(x = "", y = "") -> simple_random_sample_medium_sample_graph

data_simple_random_sample %>% 
  ggplot(aes(x, y, color = big_sample)) +
  geom_point() +
  scale_color_manual(values = c(`TRUE` = "#000000", `FALSE` = "#b4b4b4")) +
  guides(x = "none",
  y = "none",
  color = "none") +
  labs(x = "", y = "") -> simple_random_sample_big_sample_graph
```

```{r desc-statintro-simple-random-sample}
#| label: fig-simple-random-sample
#| fig-cap: "Простая случайная выборка"
#| fig-subcap:
#|   - "Генеральная совокупность"
#|   - "Выборка малого объема"
#|   - "Выборка среднего объема"
#|   - "Выборка большого объема"
#| layout-ncol: 2

print(simple_random_sample_graph)
print(simple_random_sample_little_sample_graph)
print(simple_random_sample_medium_sample_graph)
print(simple_random_sample_big_sample_graph)
```

```{=html}
<script type="text/javascript" src="./js/chapter.js"></script>
```
